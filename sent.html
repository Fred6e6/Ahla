<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>البيانات المرسلة</title>
<script src="js/roleGuard.js"></script>
<style>
body{font-family:Tahoma;background:#f5f5f5;padding:20px}
table{width:100%;background:#fff;border-collapse:collapse}
th,td{border:1px solid #ddd;padding:8px;text-align:center}
th{background:#9ccbc7}
img{width:64px;margin:4px;border:1px solid #ccc;border-radius:6px}
</style>
</head>
<body>

<h2>البيانات المرسلة</h2>
<div id="out"></div>

<script>
const user = localStorage.getItem("user");
const batches = JSON.parse(localStorage.getItem("ahla_batches"))||[];
const mine = batches.filter(b=>b.user===user);
const last = mine[mine.length-1];

if(!last){
  out.textContent="لا توجد بيانات مرسلة";
}else{
  let h=`<p><b>التاريخ:</b> ${last.date}</p>`;
  h+=`<table><tr><th>#</th><th>رقم الصنف</th><th>الكمية</th><th>السعر</th><th>الإجمالي</th></tr>`;
  last.items.forEach((i,idx)=>h+=`<tr><td>${idx+1}</td><td>${i.code}</td><td>${i.qty}</td><td>${i.price}</td><td>${i.total}</td></tr>`);
  h+=`</table><h3>صور الإرسال</h3>`;
  last.images.forEach(img=>h+=`<img src="${img}">`);
  out.innerHTML=h;
}
</script>
</body>
</html>
