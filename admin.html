<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>البيانات المستلمة</title>
<script src="js/roleGuard.js"></script>
<style>
body{font-family:Tahoma;background:#f2f2f2;padding:20px}
table{width:100%;background:#fff;border-collapse:collapse}
th,td{border:1px solid #ddd;padding:8px;text-align:center}
th{background:#343a40;color:#fff}
img{width:64px;margin:4px;border:1px solid #ccc;border-radius:6px}
hr{margin:14px 0}
</style>
</head>
<body>

<script>
if(localStorage.getItem("role")!=="admin"){ alert("غير مصرح"); location.href="index.html"; }
</script>

<h2>البيانات المستلمة من المستخدمين</h2>
<div id="all"></div>

<script>
const batches = JSON.parse(localStorage.getItem("ahla_batches"))||[];
let h="";
batches.forEach((b,i)=>{
  h+=`<h3>دفعة ${i+1} — المستخدم: ${b.user} — ${b.date}</h3>`;
  h+=`<table><tr><th>#</th><th>رقم الصنف</th><th>الكمية</th><th>السعر</th><th>الإجمالي</th></tr>`;
  b.items.forEach((it,idx)=>h+=`<tr><td>${idx+1}</td><td>${it.code}</td><td>${it.qty}</td><td>${it.price}</td><td>${it.total}</td></tr>`);
  h+=`</table><div>`;
  b.images.forEach(img=>h+=`<img src="${img}">`);
  h+=`</div><hr>`;
});
all.innerHTML = h || "لا توجد بيانات";
</script>
</body>
</html>
