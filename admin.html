<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>البيانات المستلمة</title>
<script src="js/roleGuard.js"></script>
<style>
body{font-family:Tahoma;background:#f2f2f2;padding:20px}
table{width:100%;background:#fff;border-collapse:collapse}
th,td{border:1px solid #ddd;padding:8px;text-align:center}
th{background:#343a40;color:#fff}
img{width:60px;margin:3px}
</style>
</head>

<body>

<h2>البيانات المستلمة من المستخدمين</h2>

<div id="all"></div>

<script>
if(localStorage.getItem("role")!=="admin"){
  alert("غير مصرح");
  location.href="index.html";
}

const batches = JSON.parse(localStorage.getItem("ahla_batches")) || [];
let html="";

batches.forEach((b,bi)=>{
  html+=`<h3>دفعة ${bi+1} — المستخدم: ${b.user} — ${b.date}</h3>`;
  html+="<table><tr><th>#</th><th>رقم الصنف</th><th>الكمية</th><th>السعر</th><th>الإجمالي</th></tr>";
  b.items.forEach((i,idx)=>{
    html+=`<tr><td>${idx+1}</td><td>${i.code}</td><td>${i.qty}</td><td>${i.price}</td><td>${i.total}</td></tr>`;
  });
  html+="</table><div>";
  b.images.forEach(img=>html+=`<img src="${img}">`);
  html+="</div><hr>";
});

document.getElementById("all").innerHTML = html || "لا توجد بيانات";
</script>

</body>
</html>
